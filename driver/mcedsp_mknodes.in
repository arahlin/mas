#!/bin/bash
DSP_FILE=/dev/mce_dsp
MCEC_FILE=/dev/mce_cmd
MCED_FILE=/dev/mce_data

DSP_DEV=mce_dsp
MCEC_DEV=mce_cmd
MCED_DEV=mce_data

GRP=@MAS_GROUP@

awkp="\$2==\"$DSP_DEV\" {print \$1;}"
DSP_MAJOR=`awk "$awkp" /proc/devices`

awkp="\$2==\"$MCEC_DEV\" {print \$1;}"
MCEC_MAJOR=`awk "$awkp" /proc/devices`

awkp="\$2==\"$MCED_DEV\" {print \$1;}"
MCED_MAJOR=`awk "$awkp" /proc/devices`

n_dev=1
for i in $(seq 0 $(( $n_dev-1 )) ); do

sudo mknod $DSP_FILE$i c $DSP_MAJOR $i
sudo chgrp $GRP $DSP_FILE$i
sudo chmod g+rw  $DSP_FILE$i

sudo mknod $MCEC_FILE$i c $MCEC_MAJOR $i
sudo chgrp $GRP $MCEC_FILE$i
sudo chmod g+rw  $MCEC_FILE$i

sudo mknod $MCED_FILE$i c $MCED_MAJOR $i
sudo chgrp $GRP $MCED_FILE$i
sudo chmod g+rw  $MCED_FILE$i

done
